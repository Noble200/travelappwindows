<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Allva.Desktop.ViewModels"
        x:Class="Allva.Desktop.Views.ConfirmacionImpresionView"
        x:DataType="vm:ConfirmacionImpresionViewModel"
        Title="Confirmar Impresion de Historial"
        Width="520" Height="520"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        Background="#f5f5f5">
    
    <Grid RowDefinitions="Auto,*,Auto">
        
        <!-- ENCABEZADO -->
        <Border Grid.Row="0" Background="#0b5394" Padding="20">
            <StackPanel>
                <TextBlock Text="CONFIRMAR IMPRESION"
                           FontSize="20" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="Revise los parametros antes de generar el PDF"
                           FontSize="13" Foreground="#ffffffcc" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- CONTENIDO -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20" Spacing="15">
                
                <!-- INFO GENERACION -->
                <Border Background="White" CornerRadius="8" Padding="15"
                        BoxShadow="0 1 3 0 #20000000">
                    <StackPanel Spacing="8">
                        <TextBlock Text="DATOS DE GENERACION" 
                                   FontSize="13" FontWeight="Bold" Foreground="#0b5394"/>
                        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto,Auto" Margin="0,5,0,0">
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Fecha:" FontWeight="SemiBold" Margin="0,0,15,5"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding FechaGeneracion}" Margin="0,0,0,5"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Hora:" FontWeight="SemiBold" Margin="0,0,15,5"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding HoraGeneracion}" Margin="0,0,0,5"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Usuario:" FontWeight="SemiBold" Margin="0,0,15,5"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding NombreUsuario}" Margin="0,0,0,5"/>
                            
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Local:" FontWeight="SemiBold" Margin="0,0,15,5"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding CodigoLocal}" FontWeight="Bold" Foreground="#0b5394"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- FILTROS APLICADOS -->
                <Border Background="White" CornerRadius="8" Padding="15"
                        BoxShadow="0 1 3 0 #20000000">
                    <StackPanel Spacing="8">
                        <TextBlock Text="FILTROS APLICADOS" 
                                   FontSize="13" FontWeight="Bold" Foreground="#0b5394"/>
                        
                        <ItemsControl ItemsSource="{Binding FiltrosAplicados}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:FiltroAplicadoItem">
                                    <Grid ColumnDefinitions="Auto,*" Margin="0,3">
                                        <TextBlock Grid.Column="0" Text="{Binding Nombre}" 
                                                   FontWeight="SemiBold" Margin="0,0,10,0"/>
                                        <TextBlock Grid.Column="1" Text="{Binding Valor}"/>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        
                        <TextBlock Text="Sin filtros adicionales (mes en curso)"
                                   IsVisible="{Binding SinFiltros}"
                                   FontStyle="Italic" Foreground="#666"/>
                    </StackPanel>
                </Border>
                
                <!-- RESUMEN BALANCE -->
                <Border Background="White" CornerRadius="8" Padding="15"
                        BoxShadow="0 1 3 0 #20000000">
                    <StackPanel Spacing="8">
                        <TextBlock Text="BALANCE ACTUAL" 
                                   FontSize="13" FontWeight="Bold" Foreground="#0b5394"/>
                        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" Margin="0,5,0,0">
                            <Border Grid.Row="0" Grid.Column="0" Background="#e8f4fc" 
                                    CornerRadius="5" Padding="10" Margin="0,0,5,5">
                                <StackPanel>
                                    <TextBlock Text="T.Euros" FontSize="11" Foreground="#666"/>
                                    <TextBlock Text="{Binding BalanceEuros}" FontSize="16" FontWeight="Bold" Foreground="#0b5394"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Grid.Row="0" Grid.Column="1" Background="#fff8e1" 
                                    CornerRadius="5" Padding="10" Margin="5,0,0,5">
                                <StackPanel>
                                    <TextBlock Text="T.Divisa" FontSize="11" Foreground="#666"/>
                                    <TextBlock Text="{Binding TotalDivisas}" FontSize="16" FontWeight="Bold"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Grid.Row="1" Grid.Column="0" Background="#ffebee" 
                                    CornerRadius="5" Padding="10" Margin="0,5,5,0">
                                <StackPanel>
                                    <TextBlock Text="S.Euros" FontSize="11" Foreground="#666"/>
                                    <TextBlock Text="{Binding SalidaEuros}" FontSize="16" FontWeight="Bold" Foreground="#CC3333"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Grid.Row="1" Grid.Column="1" Background="#e8f5e9" 
                                    CornerRadius="5" Padding="10" Margin="5,5,0,0">
                                <StackPanel>
                                    <TextBlock Text="E.Euros" FontSize="11" Foreground="#666"/>
                                    <TextBlock Text="{Binding EntradaEuros}" FontSize="16" FontWeight="Bold" Foreground="#008800"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- DESGLOSE DIVISAS -->
                <Border Background="White" CornerRadius="8" Padding="15"
                        BoxShadow="0 1 3 0 #20000000"
                        IsVisible="{Binding TieneDivisas}">
                    <StackPanel Spacing="8">
                        <TextBlock Text="DESGLOSE DE DIVISAS" 
                                   FontSize="13" FontWeight="Bold" Foreground="#0b5394"/>
                        <TextBlock Text="{Binding DesgloseDivisasTexto}" TextWrapping="Wrap"/>
                    </StackPanel>
                </Border>
                
                <!-- OPERACIONES -->
                <Border Background="White" CornerRadius="8" Padding="15"
                        BoxShadow="0 1 3 0 #20000000">
                    <StackPanel Spacing="8">
                        <TextBlock Text="OPERACIONES A INCLUIR" 
                                   FontSize="13" FontWeight="Bold" Foreground="#0b5394"/>
                        <TextBlock Text="{Binding CantidadOperaciones}" FontSize="16" FontWeight="Bold"/>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- BOTONES -->
        <Border Grid.Row="2" Background="White" Padding="20"
                BoxShadow="0 -1 3 0 #15000000">
            <Grid ColumnDefinitions="*,Auto,Auto">
                <TextBlock Grid.Column="0" Text="Se abrira un dialogo para elegir ubicacion"
                           VerticalAlignment="Center" Foreground="#666" FontSize="11"/>
                
                <Button Grid.Column="1" Content="Cancelar" 
                        Click="OnCancelarClick"
                        Width="100" Margin="0,0,10,0"
                        Padding="12,10"
                        Background="#e0e0e0" Foreground="#333"
                        CornerRadius="4"/>
                
                <Button Grid.Column="2" Content="Generar PDF" 
                        Click="OnGenerarClick"
                        Width="130"
                        Padding="12,10"
                        Background="#0b5394" Foreground="White" FontWeight="Bold"
                        CornerRadius="4"/>
            </Grid>
        </Border>
        
    </Grid>
</Window>
